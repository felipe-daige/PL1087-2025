import{C as j}from"./auto-sRkgK8jz.js";let R=null;function y(e){if(e==null||e==="")return 0;if(typeof e=="number")return Number.isFinite(e)?e:0;const n=parseFloat(e);return Number.isFinite(n)?n:0}function b(e){const n=Number.isFinite(e)?e:0,t=n<0?"- ":"",o=Math.abs(n).toLocaleString("pt-BR",{minimumFractionDigits:2,maximumFractionDigits:2});return`${t}R$ ${o}`}function X(e){if(e==null||e==="")return 0;if(typeof e=="number")return Number.isFinite(e)?e:0;let n=String(e).replace(/R\$\s*/g,"").replace(/\s/g,"").trim();if(!n)return 0;const t=n.includes(","),o=n.includes(".");t&&o?n=n.replace(/\./g,"").replace(",","."):t&&!o?n=n.replace(",","."):!t&&o&&(n.match(/\./g)||[]).length>1&&(n=n.replace(/\./g,"")),n=n.replace(/[^\d.]/g,"");const r=parseFloat(n);return Number.isFinite(r)?r:0}function W(e){if(!Number.isFinite(e)||e<=0)return 0;const n=e/12;let t=G(n);return Math.max(0,t*12)}function G(e){if(!Number.isFinite(e)||e<=0)return 0;let n=0;e<=5e3?n=0:e<=7350?n=Math.max(0,e*.075-375):e<=9250?n=Math.max(0,e*.15-926.25):e<=12e3?n=Math.max(0,e*.225-1620):n=Math.max(0,e*.275-2220);const t=K(e,n);return Math.max(0,n-t)}function K(e,n){if(e<=5e3)return Math.min(312.89,n);if(e<=7350){const t=978.62-.133145*e;return Math.max(0,Math.min(t,n))}return 0}function Q(){const e=document.getElementById("incomeSourcesContainer");if(!e)return[];const n=e.querySelectorAll(".income-source-row"),t=[];return n.forEach(o=>{const r=o.getAttribute("data-index"),i=o.querySelector(`select[name="incomeSources[${r}][type]"]`),l=o.querySelector(`input[name="incomeSources[${r}][name]"]`),s=o.querySelector(`input[name="incomeSources[${r}][gross]"]`),c=o.querySelector(`input[name="incomeSources[${r}][inss]"]`),u=o.querySelector(`input[name="incomeSources[${r}][irrf]"]`);t.push({type:i?i.value:"salary",name:l?l.value:"",gross:s?y(s.value):0,inss:c?y(c.value):0,irrf:u?y(u.value):0})}),t}function ee(){const e=document.getElementById("incomeSourcesContainer");if(!e)return;const t=e.querySelectorAll(".income-source-row").length,o=document.createElement("div");o.className="income-source-row bg-neutral-50 p-4 rounded-lg border border-neutral-200",o.setAttribute("data-index",t),o.innerHTML=`
        <div class="flex justify-between items-start mb-3">
            <h5 class="text-sm font-semibold text-neutral-800">Fonte de Renda #${t+1}</h5>
            <button type="button" onclick="removeIncomeSource(${t})" class="remove-income-source-btn p-2 text-sm text-red-600 hover:text-red-700 hover:bg-red-50 border border-red-200 rounded-lg transition-colors">
                <svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 7l-.867 12.142A2 2 0 0116.138 21H7.862a2 2 0 01-1.995-1.858L5 7m5 4v6m4-6v6m1-10V4a1 1 0 00-1-1h-4a1 1 0 00-1 1v3M4 7h16"></path>
                </svg>
            </button>
        </div>
        <div class="space-y-4">
            <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
                <div>
                    <label class="block text-sm font-medium text-neutral-700 mb-1">Tipo</label>
                    <select name="incomeSources[${t}][type]" class="form-select w-full p-3 text-sm border border-neutral-300 rounded-lg focus:ring-brand-500 focus:border-brand-500 outline-none">
                        <option value="salary">Salário CLT</option>
                        <option value="prolabore">Pró-Labore</option>
                        <option value="autonomous">Autônomo</option>
                        <option value="retirement">Aposentadoria</option>
                    </select>
                </div>
                <div>
                    <label class="block text-sm font-medium text-neutral-700 mb-1">Nome da Fonte</label>
                    <input type="text" name="incomeSources[${t}][name]" placeholder="Ex: Empresa XYZ" class="w-full p-3 text-sm border border-neutral-300 rounded-lg focus:ring-brand-500 focus:border-brand-500 outline-none income-source-input">
                </div>
            </div>
            <div>
                <label class="block text-sm font-medium text-neutral-700 mb-1">Bruto Anual</label>
                <div class="relative">
                    <span class="absolute left-3 top-3 text-neutral-400 text-sm">R$</span>
                    <input type="number" step="0.01" name="incomeSources[${t}][gross]" placeholder="0.00" class="pl-10 w-full p-3 text-sm border border-neutral-300 rounded-lg focus:ring-brand-500 focus:border-brand-500 outline-none income-source-input">
                </div>
            </div>
            <div>
                <label class="block text-sm font-medium text-neutral-700 mb-1">INSS Retido ou Pago (GPS) <span class="text-neutral-500 font-normal">(anual)</span></label>
                <div class="relative">
                    <span class="absolute left-3 top-3 text-neutral-400 text-sm">R$</span>
                    <input type="number" step="0.01" name="incomeSources[${t}][inss]" placeholder="0.00" class="pl-10 w-full p-3 text-sm border border-neutral-300 rounded-lg focus:ring-brand-500 focus:border-brand-500 outline-none income-source-input">
                </div>
            </div>
            <div>
                <label class="block text-sm font-medium text-neutral-700 mb-1">IRRF Retido <span class="text-neutral-500 font-normal">(anual)</span></label>
                <div class="relative">
                    <span class="absolute left-3 top-3 text-neutral-400 text-sm">R$</span>
                    <input type="number" step="0.01" name="incomeSources[${t}][irrf]" placeholder="0.00" class="pl-10 w-full p-3 text-sm border border-neutral-300 rounded-lg focus:ring-brand-500 focus:border-brand-500 outline-none income-source-input">
                </div>
            </div>
        </div>
    `,e.appendChild(o),B(),o.querySelectorAll("input, select").forEach(i=>{i.addEventListener("input",f),i.addEventListener("change",f),i.type!=="checkbox"&&i.type!=="submit"&&i.type!=="button"&&i.addEventListener("keydown",k)}),f()}function te(e){const n=document.getElementById("incomeSourcesContainer");if(!n)return;const t=n.querySelector(`.income-source-row[data-index="${e}"]`);!t||n.querySelectorAll(".income-source-row").length<=1||(t.remove(),ne(),B(),f())}function ne(){const e=document.getElementById("incomeSourcesContainer");if(!e)return;e.querySelectorAll(".income-source-row").forEach((t,o)=>{t.setAttribute("data-index",o);const r=t.querySelector("h5");r&&(r.textContent=`Fonte de Renda #${o+1}`);const i=t.querySelector('select[name*="[type]"]'),l=t.querySelector('input[name*="[name]"]'),s=t.querySelector('input[name*="[gross]"]'),c=t.querySelector('input[name*="[inss]"]'),u=t.querySelector('input[name*="[irrf]"]'),d=t.querySelector(".remove-income-source-btn");i&&(i.name=`incomeSources[${o}][type]`),l&&(l.name=`incomeSources[${o}][name]`),s&&(s.name=`incomeSources[${o}][gross]`),c&&(c.name=`incomeSources[${o}][inss]`),u&&(u.name=`incomeSources[${o}][irrf]`),d&&d.setAttribute("onclick",`removeIncomeSource(${o})`)})}function B(){const e=document.getElementById("incomeSourcesContainer");if(!e)return;const n=e.querySelectorAll(".income-source-row");e.querySelectorAll(".remove-income-source-btn").forEach(o=>{n.length<=1?o.classList.add("hidden"):o.classList.remove("hidden")})}function oe(){const e=document.getElementById("rentalPropertiesContainer");if(!e)return[];const n=e.querySelectorAll(".rental-property-row"),t=[];return n.forEach(o=>{const r=o.getAttribute("data-index"),i=o.querySelector(`input[name="rentalProperties[${r}][name]"]`),l=o.querySelector(`select[name="rentalProperties[${r}][periodicity]"]`),s=o.querySelector(`input[name="rentalProperties[${r}][gross]"]`),c=o.querySelector(`input[name="rentalProperties[${r}][admin_fee]"]`),u=o.querySelector(`input[name="rentalProperties[${r}][iptu]"]`),d=o.querySelector(`input[name="rentalProperties[${r}][condo]"]`);t.push({name:i?i.value:"",periodicity:l?l.value:"monthly",gross:s?y(s.value):0,admin_fee:c?y(c.value):0,iptu:u?y(u.value):0,condo:d?y(d.value):0})}),t}function re(){const e=document.getElementById("rentalPropertiesContainer");if(!e)return;const t=e.querySelectorAll(".rental-property-row").length,o=document.createElement("div");o.className="rental-property-row bg-neutral-50 p-4 rounded-lg border border-neutral-200",o.setAttribute("data-index",t),o.innerHTML=`
        <div class="flex justify-between items-start mb-3">
            <h5 class="text-sm font-semibold text-neutral-800">Imóvel #${t+1}</h5>
            <button type="button" onclick="removeRentalProperty(${t})" class="remove-rental-btn p-2 text-sm text-red-600 hover:text-red-700 hover:bg-red-50 border border-red-200 rounded-lg transition-colors">
                <svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 7l-.867 12.142A2 2 0 0116.138 21H7.862a2 2 0 01-1.995-1.858L5 7m5 4v6m4-6v6m1-10V4a1 1 0 00-1-1h-4a1 1 0 00-1 1v3M4 7h16"></path>
                </svg>
            </button>
        </div>
        <div class="space-y-4">
            <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
                <div>
                    <label class="block text-sm font-medium text-neutral-700 mb-1">Identificação do Imóvel</label>
                    <input type="text" name="rentalProperties[${t}][name]" placeholder="Ex: Apt Centro" class="w-full p-3 text-sm border border-neutral-300 rounded-lg focus:ring-brand-500 focus:border-brand-500 outline-none">
                </div>
                <div>
                    <label class="block text-sm font-medium text-neutral-700 mb-1">Periodicidade</label>
                    <select name="rentalProperties[${t}][periodicity]" class="form-select rental-periodicity-select w-full p-3 text-sm border border-neutral-300 rounded-lg focus:ring-brand-500 focus:border-brand-500 outline-none" onchange="updateRentalLabels(${t})">
                        <option value="monthly">Mensais</option>
                        <option value="annual">Anuais</option>
                    </select>
                </div>
            </div>
            <div>
                <label class="block text-sm font-medium text-neutral-700 mb-1">Aluguel Bruto <span class="rental-label-gross text-neutral-500 font-normal"></span></label>
                <div class="relative">
                    <span class="absolute left-3 top-3 text-neutral-400 text-sm">R$</span>
                    <input type="number" step="0.01" name="rentalProperties[${t}][gross]" placeholder="0.00" class="pl-10 w-full p-3 text-sm border border-neutral-300 rounded-lg focus:ring-brand-500 focus:border-brand-500 outline-none">
                </div>
            </div>
            <div>
                <label class="block text-sm font-medium text-neutral-700 mb-1">Taxa Adm. <span class="rental-label-admin text-neutral-500 font-normal"></span></label>
                <div class="relative">
                    <span class="absolute left-3 top-3 text-neutral-400 text-sm">R$</span>
                    <input type="number" step="0.01" name="rentalProperties[${t}][admin_fee]" placeholder="0.00" class="pl-10 w-full p-3 text-sm border border-neutral-300 rounded-lg focus:ring-brand-500 focus:border-brand-500 outline-none">
                </div>
            </div>
            <div>
                <label class="block text-sm font-medium text-neutral-700 mb-1">
                    IPTU
                    <span class="rental-label-iptu block text-neutral-500 font-normal text-xs"></span>
                </label>
                <div class="relative">
                    <span class="absolute left-3 top-3 text-neutral-400 text-sm">R$</span>
                    <input type="number" step="0.01" name="rentalProperties[${t}][iptu]" placeholder="0.00" class="pl-10 w-full p-3 text-sm border border-neutral-300 rounded-lg focus:ring-brand-500 focus:border-brand-500 outline-none">
                </div>
            </div>
            <div>
                <label class="block text-sm font-medium text-neutral-700 mb-1">Condomínio <span class="rental-label-condo text-neutral-500 font-normal"></span></label>
                <div class="relative">
                    <span class="absolute left-3 top-3 text-neutral-400 text-sm">R$</span>
                    <input type="number" step="0.01" name="rentalProperties[${t}][condo]" placeholder="0.00" class="pl-10 w-full p-3 text-sm border border-neutral-300 rounded-lg focus:ring-brand-500 focus:border-brand-500 outline-none">
                </div>
            </div>
        </div>
    `,e.appendChild(o),M(),F(t),o.querySelectorAll("input, select").forEach(i=>{i.addEventListener("input",f),i.addEventListener("change",f),i.type!=="checkbox"&&i.type!=="submit"&&i.type!=="button"&&i.addEventListener("keydown",k)}),f()}function ie(e){const n=document.getElementById("rentalPropertiesContainer");if(!n)return;const t=n.querySelector(`.rental-property-row[data-index="${e}"]`);!t||n.querySelectorAll(".rental-property-row").length<=1||(t.remove(),ae(),M(),f())}function ae(){const e=document.getElementById("rentalPropertiesContainer");if(!e)return;e.querySelectorAll(".rental-property-row").forEach((t,o)=>{t.setAttribute("data-index",o);const r=t.querySelector("h5");r&&(r.textContent=`Imóvel #${o+1}`);const i=t.querySelector('input[name*="[name]"]'),l=t.querySelector('select[name*="[periodicity]"]'),s=t.querySelector('input[name*="[gross]"]'),c=t.querySelector('input[name*="[admin_fee]"]'),u=t.querySelector('input[name*="[iptu]"]'),d=t.querySelector('input[name*="[condo]"]'),a=t.querySelector(".remove-rental-btn");i&&(i.name=`rentalProperties[${o}][name]`),l&&(l.name=`rentalProperties[${o}][periodicity]`,l.setAttribute("onchange",`updateRentalLabels(${o})`)),s&&(s.name=`rentalProperties[${o}][gross]`),c&&(c.name=`rentalProperties[${o}][admin_fee]`),u&&(u.name=`rentalProperties[${o}][iptu]`),d&&(d.name=`rentalProperties[${o}][condo]`),a&&a.setAttribute("onclick",`removeRentalProperty(${o})`)})}function F(e){const n=document.querySelector(`.rental-property-row[data-index="${e}"]`);if(!n)return;const t=n.querySelector(`select[name="rentalProperties[${e}][periodicity]"]`);if(!t)return;const r=t.value==="annual",i=n.querySelector(".rental-label-gross"),l=n.querySelector(".rental-label-admin"),s=n.querySelector(".rental-label-iptu"),c=n.querySelector(".rental-label-condo");i&&(i.textContent=r?"(total anual)":"(mensal)"),l&&(l.textContent=r?"(total anual)":"(mensal)"),s&&(s.textContent=r?"(total anual)":"(mensal)"),c&&(c.textContent=r?"(total anual)":"(mensal)"),f()}function M(){const e=document.getElementById("rentalPropertiesContainer");if(!e)return;const n=e.querySelectorAll(".rental-property-row");e.querySelectorAll(".remove-rental-btn").forEach(o=>{n.length<=1?o.classList.add("hidden"):o.classList.remove("hidden")})}function se(){const e=a=>{const m=document.getElementById(a);return m?y(m.value):0},n=a=>{const m=document.getElementById(a);return m?m.checked:!1},t=document.getElementById("birthDate"),o=t&&t.value!==""?t.value:null,r=Q(),i=oe();let l=0,s=0,c=0;r.forEach(a=>{l+=a.gross||0,s+=a.inss||0,c+=a.irrf||0});let u=0,d=0;return i.forEach(a=>{const p=(a.periodicity||"monthly")==="annual",g=p?(a.gross||0)/12:a.gross||0,x=p?(a.admin_fee||0)/12:a.admin_fee||0,h=p?(a.iptu||0)/12:a.iptu||0,S=p?(a.condo||0)/12:a.condo||0,v=x+h+S;u+=g,d+=Math.max(0,g-v)}),{birthDate:o,seriousIllness:n("seriousIllness"),incomeSources:r,rentalProperties:i,incomeMonthly:l/12,incomeAnnual:l,income13:e("income13"),dividendsTotal:e("dividendsTotal"),dividendsExcess:e("dividendsExcess"),jcpTotal:e("jcpTotal"),irrfJcpWithheld:e("irrfJcpWithheld"),financialInvestments:e("financialInvestments"),irrfExclusiveOther:e("irrfExclusiveOther"),taxExemptInvestments:e("taxExemptInvestments"),fiiDividends:e("fiiDividends"),otherExempt:e("otherExempt"),accountingProfit:e("accountingProfit"),distributedProfit:e("distributedProfit"),irpjPaid:e("irpjPaid"),csllPaid:e("csllPaid"),ownershipPercentage:e("ownershipPercentage")||100,incomeOther:d,taxPaid:e("taxPaid"),totalIrrfRetido:c,totalInssRetido:s,totalRentalGross:u,totalRentalNet:d,dependents:(()=>{const a=document.getElementById("dependents"),m=a&&a.value!==""?parseInt(a.value,10):0;return Number.isFinite(m)&&m>0?m:0})(),deductionHealth:e("deductionHealth"),deductionEducation:e("deductionEducation"),deductionPGBL:e("deductionPGBL")}}function le(e){if(!e||e<=0)return 0;const n=6e5;return e<=n?0:e-n}function _(){const e=document.getElementById("dividendsTotal"),n=document.getElementById("dividendsExcess"),t=document.getElementById("dividendsTaxInfo"),o=document.getElementById("dividendsExcessDisplay"),r=document.getElementById("dividendsTaxDisplay");if(!e||!n)return;const i=e.value,l=X(i),s=le(l),c=s*.1;n.value=s.toFixed(2),s>0&&t&&o&&r?(t.classList.remove("hidden"),o.textContent=s.toLocaleString("pt-BR",{minimumFractionDigits:2,maximumFractionDigits:2,style:"currency",currency:"BRL"}),r.textContent=c.toLocaleString("pt-BR",{minimumFractionDigits:2,maximumFractionDigits:2,style:"currency",currency:"BRL"})):t&&t.classList.add("hidden"),n.dispatchEvent(new Event("input",{bubbles:!0}))}function ce(e){let n=e.incomeAnnual||(e.incomeMonthly?e.incomeMonthly*12:0),t=n+e.totalRentalNet*12,o=0;if(e.birthDate){const w=new Date(e.birthDate),q=new Date;o=q.getFullYear()-w.getFullYear();const O=q.getMonth()-w.getMonth();(O<0||O===0&&q.getDate()<w.getDate())&&o--}o>=65&&(t=Math.max(0,t-24e3)),e.seriousIllness&&(t=e.totalRentalNet*12);const r=Math.min(t*window.IRPF_CONSTANTS.simplifiedRate,window.IRPF_CONSTANTS.simplifiedCap),i=t-r,l=W(Math.max(0,i));let s=!1,c=e.deductionEducation;c>window.IRPF_CONSTANTS.educationCap&&(s=!0,c=window.IRPF_CONSTANTS.educationCap);const u=Math.max(0,t*.12),d=Math.min(e.deductionPGBL,u),a=e.dependents*window.IRPF_CONSTANTS.deductionPerDependent+e.deductionHealth+c+d,m=Math.max(0,t-a),p=W(m),g=e.dividendsExcess>0?e.dividendsExcess*.1:0,x=e.irrfJcpWithheld&&e.irrfJcpWithheld>0?e.irrfJcpWithheld:(e.jcpTotal||0)*.15,h=e.income13>0?G(e.income13):0,S=Math.min(l,p),v=l<p,A=y(window.IRPFM_ADDITIONAL||0),T=S+g+h+A,V=A>0,N=(e.taxPaid||0)+(e.totalIrrfRetido||0),J=g+x+(e.irrfExclusiveOther||0),U=V?N+J:N,I=T-U,C=I<0,Y=C?Math.abs(I):I,E=n+e.totalRentalGross*12+e.income13+(e.dividendsTotal||0)+(e.jcpTotal||0)+(e.financialInvestments||0)+(e.taxExemptInvestments||0)+(e.fiiDividends||0),Z=E>0?T/E*100:0;let L="SEM SALDO",$="text-sm font-bold text-neutral-600 mt-1",D="border-neutral-300";I>0?(L="IMPOSTO A PAGAR",$="text-sm font-bold text-red-600 mt-1",D="border-red-500"):C&&(L="A RESTITUIR",$="text-sm font-bold text-green-600 mt-1",D="border-green-500");let P="Preencha os dados para ver qual regime compensa mais.";E>0&&(Math.abs(l-p)<10?P="Resultados similares em ambos os regimes.":v?P='<span class="text-brand-700 font-bold">Recomendação:</span> O Desconto Simplificado economiza <strong>'+b(p-l)+"</strong>.":P='<span class="text-green-700 font-bold">Recomendação:</span> As Deduções Legais economizam <strong>'+b(l-p)+"</strong>.");const z={simplified:Math.round((l+g)*100)/100,legal:Math.round((p+g)*100)/100};return{grossTaxable:t,simplifiedDiscount:r,totalDeductions:a,dividendTax:g,irpfmAdditional:A,totalTaxLiability:T,taxPaid:e.taxPaid,finalResult:I,displayFinalResult:Y,effectiveRate:Z,resultLabel:L,resultClass:$,cardBorder:D,recommendationText:P,educationWarning:s,chartData:z,isNegativeFinalResult:C,totalIncome:E}}function de(e,n){const t=(h,S)=>{const v=document.getElementById(h);v&&(v.textContent=S)};t("displayGrossIncome",b(n.grossTaxable)),t("displaySimplifiedDisc",`- ${b(n.simplifiedDiscount)}`),t("displayLegalDed",`- ${b(n.totalDeductions)}`),n.dividendTax>0&&t("displayDivTax",`+ ${b(n.dividendTax)}`);const o=document.getElementById("displayIrpfm");o&&(n.irpfmAdditional>0?(o.textContent=`+ ${b(n.irpfmAdditional)}`,o.parentElement.classList.remove("hidden")):o.parentElement.classList.add("hidden")),t("displayTaxDue",b(n.totalTaxLiability));const r=e.dividendsExcess>0?e.dividendsExcess*.1:0,i=e.irrfJcpWithheld&&e.irrfJcpWithheld>0?e.irrfJcpWithheld:(e.jcpTotal||0)*.15,l=n.irpfmAdditional>0,s=(e.taxPaid||0)+(e.totalIrrfRetido||0),c=r+i+(e.irrfExclusiveOther||0),u=l?s+c:s;t("displayTaxPaid",`- ${b(u)}`);const d=document.getElementById("finalResultValue");d&&(d.textContent=b(n.displayFinalResult));const a=document.getElementById("resultStatus");a&&(a.textContent=n.resultLabel,a.className=n.resultClass);const m=document.getElementById("resultCard");m&&(m.classList.remove("border-neutral-300","border-red-500","border-green-500"),m.classList.add(n.cardBorder));const p=document.getElementById("effectiveRate");p&&(p.textContent=`${n.effectiveRate.toLocaleString("pt-BR",{minimumFractionDigits:2,maximumFractionDigits:2})}%`);const g=document.getElementById("recommendationText");g&&(g.innerHTML=n.recommendationText);const x=document.getElementById("educationWarning");x&&x.classList.toggle("hidden",!n.educationWarning)}function ue(e){window.chartPayload&&(window.chartPayload.simplified=e.chartData.simplified,window.chartPayload.legal=e.chartData.legal,R&&(R.data.datasets[0].data=[window.chartPayload.simplified,window.chartPayload.legal],R.update()))}function f(){const e=se(),n=ce(e);de(e,n),ue(n)}function H(e){document.querySelectorAll(".step-content").forEach(r=>r.classList.remove("active"));const n=document.getElementById(`step${e}`);n&&n.classList.add("active");const t=Math.min(100,Math.max(20,e*20)),o=document.getElementById("progressBar");o&&(o.style.width=`${t}%`),window.scrollTo({top:0,behavior:"smooth"})}function me(e,n){const t=document.getElementById(e);if(!t)return;let o=parseInt(t.value||"0",10)+n;o<0&&(o=0),t.value=o,f()}function pe(){const e=document.getElementById("detailsContent"),n=document.getElementById("detailsArrow");e&&e.classList.toggle("hidden"),n&&n.classList.toggle("rotate-180")}function fe(e){document.querySelectorAll(".product-content").forEach(o=>o.classList.add("hidden")),document.querySelectorAll(".product-tab").forEach(o=>{o.classList.remove("text-brand-700","bg-brand-50","border-b-2","border-brand-600"),o.classList.add("text-neutral-500")});const n=document.getElementById("content-"+e);n&&n.classList.remove("hidden");const t=document.getElementById("tab-"+e);t&&(t.classList.remove("text-neutral-500"),t.classList.add("text-brand-700","bg-brand-50","border-b-2","border-brand-600"))}function be(){confirm("Deseja reiniciar o simulador?")&&(window.location=window.location.pathname)}function ge(){const e=document.getElementById("comparisonChart");e&&window.chartPayload&&(R=new j(e.getContext("2d"),{type:"bar",data:{labels:["Simplificado","Completo"],datasets:[{label:"Imposto Anual",data:[window.chartPayload.simplified,window.chartPayload.legal],backgroundColor:["rgba(59, 130, 246, 0.8)","rgba(34, 197, 94, 0.8)"],borderColor:["rgb(59, 130, 246)","rgb(34, 197, 94)"],borderWidth:2,borderRadius:8}]},options:{indexAxis:"y",responsive:!0,maintainAspectRatio:!1,plugins:{legend:{display:!1},tooltip:{callbacks:{label:function(t){return b(t.parsed.x)}}}},scales:{x:{beginAtZero:!0,grid:{display:!1},ticks:{callback:function(t){return"R$ "+(t/1e3).toFixed(0)+"k"}}},y:{grid:{display:!1}}}}}));const n=document.getElementById("holdingChart");n&&window.holdingData&&new j(n.getContext("2d"),{type:"bar",data:{labels:["PF","Holding"],datasets:[{label:"Imposto Mensal",data:[window.holdingData.pf||0,window.holdingData.pj||0],backgroundColor:["rgba(239, 68, 68, 0.8)","rgba(34, 197, 94, 0.8)"],borderRadius:8}]},options:{indexAxis:"y",responsive:!0,maintainAspectRatio:!1,plugins:{legend:{display:!1},tooltip:{callbacks:{label:function(t){return b(t.parsed.x)+"/mês"}}}},scales:{x:{beginAtZero:!0,grid:{display:!1}},y:{grid:{display:!1}}}}})}function k(e){if(e.key!=="Enter")return;e.preventDefault(),e.stopPropagation();const n=e.target,t=n.closest("form");if(!t)return;const o=n.closest(".step-content");if(!o)return;const r=o.querySelectorAll('input:not([type="hidden"]):not([type="submit"]):not([type="button"]):not([readonly]):not([disabled]), select:not([disabled]), textarea:not([readonly]):not([disabled])'),i=Array.from(r),l=i.indexOf(n);if(l===-1)return;let s=null;for(let d=l+1;d<i.length;d++){const a=i[d];if(a.offsetParent!==null){s=a;break}}if(s){s.focus(),s.tagName==="INPUT"&&(s.type==="text"||s.type==="number")&&s.select();return}const c=o.id,u=parseInt(c.replace("step",""));if(u<5)H(u+1),setTimeout(()=>{const d=document.getElementById(`step${u+1}`);if(d){const a=d.querySelector('input:not([type="hidden"]):not([type="submit"]):not([type="button"]):not([readonly]):not([disabled]), select:not([disabled]), textarea:not([readonly]):not([disabled])');a&&a.offsetParent!==null&&(a.focus(),a.tagName==="INPUT"&&(a.type==="text"||a.type==="number")&&a.select())}},150);else{const d=t.querySelector('button[type="submit"]');d&&d.click()}}function ye(){document.querySelectorAll('input[type="number"], input[type="checkbox"], input[type="text"], select, textarea').forEach(o=>{const r=o.type==="checkbox"?"change":"input";o.addEventListener(r,f),o.type!=="checkbox"&&o.type!=="submit"&&o.type!=="button"&&o.addEventListener("keydown",k,!0)});const n=document.getElementById("dividendsTotal");n&&n.addEventListener("input",function(o){_(),f()}),B(),M(),document.querySelectorAll(".rental-property-row").forEach(o=>{const r=o.getAttribute("data-index");r!==null&&F(parseInt(r,10))}),_(),f()}function xe(){const e=document.getElementById("resultCard");e&&(e.scrollIntoView({behavior:"smooth",block:"center"}),e.classList.add("ring-4","ring-brand-300","transform","scale-105"),setTimeout(()=>{e.classList.remove("ring-4","ring-brand-300","transform","scale-105")},1e3))}window.allowFormSubmit=!1;document.addEventListener("DOMContentLoaded",()=>{ge(),ye();const e=document.getElementById("taxForm");if(e){const n=e.querySelector('button[type="submit"]');n&&n.addEventListener("click",t=>{window.allowFormSubmit=!0}),e.addEventListener("submit",t=>{if(!window.allowFormSubmit)return t.preventDefault(),t.stopPropagation(),t.stopImmediatePropagation(),!1;window.allowFormSubmit=!1},!0),window.allowFormSubmit=!1}window.hasSubmission&&xe()});window.nextStep=H;window.adjustCounter=me;window.toggleDetails=pe;window.showProductTab=fe;window.resetApp=be;window.addIncomeSource=ee;window.removeIncomeSource=te;window.addRentalProperty=re;window.removeRentalProperty=ie;window.updateRentalLabels=F;
