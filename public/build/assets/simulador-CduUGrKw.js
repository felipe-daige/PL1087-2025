import{C as _}from"./auto-sRkgK8jz.js";let C=null;function y(e){return e==null||e===""?0:typeof e=="number"?Number.isFinite(e)?e:0:w(e)}function b(e){const t=Number.isFinite(e)?e:0,n=t<0?"- ":"",o=Math.abs(t).toLocaleString("pt-BR",{minimumFractionDigits:2,maximumFractionDigits:2});return`${n}R$ ${o}`}function w(e){if(e==null||e==="")return 0;if(typeof e=="number")return Number.isFinite(e)?e:0;let t=String(e).replace(/R\$\s*/g,"").replace(/\s/g,"").trim();if(!t)return 0;const n=t.includes(","),o=t.includes(".");n&&o?t=t.replace(/\./g,"").replace(",","."):n&&!o?t=t.replace(",","."):!n&&o&&(t.match(/\./g)||[]).length>1&&(t=t.replace(/\./g,"")),t=t.replace(/[^\d.]/g,"");const i=parseFloat(t);return Number.isFinite(i)?i:0}function Q(e){if(!e)return;let n=e.value.replace(/[^\d,]/g,"");if(!n){e.value="";return}const o=n.includes(",");let i="",r="";if(o){const c=n.indexOf(",");i=n.substring(0,c).replace(/\D/g,""),r=n.substring(c+1).replace(/\D/g,"").substring(0,2)}else i=n.replace(/\D/g,""),r="";i||(i="0");let a=i.replace(/\B(?=(\d{3})+(?!\d))/g,".");r?a+=","+r:o&&(a+=","),e.value=a}function D(e){e&&(e.addEventListener("input",function(t){Q(t.target)}),e.addEventListener("blur",function(t){const n=t.target.value,o=w(n);if(o>0)if(n.includes(",")||n.includes(".")&&n.split(".").length>2){const r=o.toLocaleString("pt-BR",{minimumFractionDigits:2,maximumFractionDigits:2});t.target.value=r}else{const r=o.toLocaleString("pt-BR",{minimumFractionDigits:0,maximumFractionDigits:0});t.target.value=r}else(n.trim()===""||o===0)&&(t.target.value="")}),e.addEventListener("paste",function(t){t.preventDefault();const n=(t.clipboardData||window.clipboardData).getData("text"),o=w(n);o>0&&(t.target.value=o.toLocaleString("pt-BR",{minimumFractionDigits:2,maximumFractionDigits:2}),t.target.dispatchEvent(new Event("input",{bubbles:!0})))}),e.addEventListener("keydown",function(t){[8,9,27,13,46,35,36,37,38,39,40].indexOf(t.keyCode)!==-1||t.keyCode===65&&t.ctrlKey===!0||t.keyCode===67&&t.ctrlKey===!0||t.keyCode===86&&t.ctrlKey===!0||t.keyCode===88&&t.ctrlKey===!0||(t.shiftKey||t.keyCode<48||t.keyCode>57)&&(t.keyCode<96||t.keyCode>105)&&t.keyCode!==188&&t.keyCode!==190&&t.preventDefault()}))}function V(e){if(!Number.isFinite(e)||e<=0)return 0;const t=e/12;let n=H(t);return Math.max(0,n*12)}function H(e){if(!Number.isFinite(e)||e<=0)return 0;let t=0;e<=5e3?t=0:e<=7350?t=Math.max(0,e*.075-375):e<=9250?t=Math.max(0,e*.15-926.25):e<=12e3?t=Math.max(0,e*.225-1620):t=Math.max(0,e*.275-2220);const n=ee(e,t);return Math.max(0,t-n)}function ee(e,t){if(e<=5e3)return Math.min(312.89,t);if(e<=7350){const n=978.62-.133145*e;return Math.max(0,Math.min(n,t))}return 0}function te(){const e=document.getElementById("incomeSourcesContainer");if(!e)return[];const t=e.querySelectorAll(".income-source-row"),n=[];return t.forEach(o=>{const i=o.getAttribute("data-index"),r=o.querySelector(`select[name="incomeSources[${i}][type]"]`),l=o.querySelector(`input[name="incomeSources[${i}][name]"]`),a=o.querySelector(`input[name="incomeSources[${i}][gross]"]`),c=o.querySelector(`input[name="incomeSources[${i}][inss]"]`),u=o.querySelector(`input[name="incomeSources[${i}][irrf]"]`);n.push({type:r?r.value:"salary",name:l?l.value:"",gross:a?y(a.value):0,inss:c?y(c.value):0,irrf:u?y(u.value):0})}),n}function ne(){const e=document.getElementById("incomeSourcesContainer");if(!e)return;const n=e.querySelectorAll(".income-source-row").length,o=document.createElement("div");o.className="income-source-row bg-neutral-50 p-4 rounded-lg border border-neutral-200",o.setAttribute("data-index",n),o.innerHTML=`
        <div class="flex justify-between items-start mb-3">
            <h5 class="text-sm font-semibold text-neutral-800">Fonte de Renda #${n+1}</h5>
            <button type="button" onclick="removeIncomeSource(${n})" class="remove-income-source-btn p-2 text-sm text-red-600 hover:text-red-700 hover:bg-red-50 border border-red-200 rounded-lg transition-colors">
                <svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 7l-.867 12.142A2 2 0 0116.138 21H7.862a2 2 0 01-1.995-1.858L5 7m5 4v6m4-6v6m1-10V4a1 1 0 00-1-1h-4a1 1 0 00-1 1v3M4 7h16"></path>
                </svg>
            </button>
        </div>
        <div class="space-y-4">
            <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
                <div>
                    <label class="block text-sm font-medium text-neutral-700 mb-1">Tipo</label>
                    <select name="incomeSources[${n}][type]" class="form-select w-full p-3 text-sm border border-neutral-300 rounded-lg focus:ring-brand-500 focus:border-brand-500 outline-none">
                        <option value="salary">Salário CLT</option>
                        <option value="prolabore">Pró-Labore</option>
                        <option value="autonomous">Autônomo</option>
                        <option value="retirement">Aposentadoria</option>
                    </select>
                </div>
                <div>
                    <label class="block text-sm font-medium text-neutral-700 mb-1">Nome da Fonte</label>
                    <input type="text" name="incomeSources[${n}][name]" placeholder="Ex: Empresa XYZ" class="w-full p-3 text-sm border border-neutral-300 rounded-lg focus:ring-brand-500 focus:border-brand-500 outline-none income-source-input">
                </div>
            </div>
            <div>
                <label class="block text-sm font-medium text-neutral-700 mb-1">Bruto Anual</label>
                <div class="relative">
                    <span class="absolute left-3 top-3 text-neutral-400 text-sm">R$</span>
                    <input type="text" name="incomeSources[${n}][gross]" placeholder="0,00" class="currency-input pl-10 w-full p-3 text-sm border border-neutral-300 rounded-lg focus:ring-brand-500 focus:border-brand-500 outline-none income-source-input">
                </div>
            </div>
            <div>
                <label class="block text-sm font-medium text-neutral-700 mb-1">INSS Retido ou Pago (GPS) <span class="text-neutral-500 font-normal">(anual)</span></label>
                <div class="relative">
                    <span class="absolute left-3 top-3 text-neutral-400 text-sm">R$</span>
                    <input type="text" name="incomeSources[${n}][inss]" placeholder="0,00" class="currency-input pl-10 w-full p-3 text-sm border border-neutral-300 rounded-lg focus:ring-brand-500 focus:border-brand-500 outline-none income-source-input">
                </div>
            </div>
            <div>
                <label class="block text-sm font-medium text-neutral-700 mb-1">IRRF Retido <span class="text-neutral-500 font-normal">(anual)</span></label>
                <div class="relative">
                    <span class="absolute left-3 top-3 text-neutral-400 text-sm">R$</span>
                    <input type="text" name="incomeSources[${n}][irrf]" placeholder="0,00" class="currency-input pl-10 w-full p-3 text-sm border border-neutral-300 rounded-lg focus:ring-brand-500 focus:border-brand-500 outline-none income-source-input">
                </div>
            </div>
        </div>
    `,e.appendChild(o),q(),o.querySelectorAll("input, select").forEach(r=>{r.addEventListener("input",f),r.addEventListener("change",f),r.type!=="checkbox"&&r.type!=="submit"&&r.type!=="button"&&r.addEventListener("keydown",O),r.classList.contains("currency-input")&&D(r)}),f()}function oe(e){const t=document.getElementById("incomeSourcesContainer");if(!t)return;const n=t.querySelector(`.income-source-row[data-index="${e}"]`);!n||t.querySelectorAll(".income-source-row").length<=1||(n.remove(),re(),q(),f())}function re(){const e=document.getElementById("incomeSourcesContainer");if(!e)return;e.querySelectorAll(".income-source-row").forEach((n,o)=>{n.setAttribute("data-index",o);const i=n.querySelector("h5");i&&(i.textContent=`Fonte de Renda #${o+1}`);const r=n.querySelector('select[name*="[type]"]'),l=n.querySelector('input[name*="[name]"]'),a=n.querySelector('input[name*="[gross]"]'),c=n.querySelector('input[name*="[inss]"]'),u=n.querySelector('input[name*="[irrf]"]'),d=n.querySelector(".remove-income-source-btn");r&&(r.name=`incomeSources[${o}][type]`),l&&(l.name=`incomeSources[${o}][name]`),a&&(a.name=`incomeSources[${o}][gross]`),c&&(c.name=`incomeSources[${o}][inss]`),u&&(u.name=`incomeSources[${o}][irrf]`),d&&d.setAttribute("onclick",`removeIncomeSource(${o})`)})}function q(){const e=document.getElementById("incomeSourcesContainer");if(!e)return;const t=e.querySelectorAll(".income-source-row");e.querySelectorAll(".remove-income-source-btn").forEach(o=>{t.length<=1?o.classList.add("hidden"):o.classList.remove("hidden")})}function ie(){const e=document.getElementById("rentalPropertiesContainer");if(!e)return[];const t=e.querySelectorAll(".rental-property-row"),n=[];return t.forEach(o=>{const i=o.getAttribute("data-index"),r=o.querySelector(`input[name="rentalProperties[${i}][name]"]`),l=o.querySelector(`select[name="rentalProperties[${i}][periodicity]"]`),a=o.querySelector(`input[name="rentalProperties[${i}][gross]"]`),c=o.querySelector(`input[name="rentalProperties[${i}][admin_fee]"]`),u=o.querySelector(`input[name="rentalProperties[${i}][iptu]"]`),d=o.querySelector(`input[name="rentalProperties[${i}][condo]"]`);n.push({name:r?r.value:"",periodicity:l?l.value:"monthly",gross:a?y(a.value):0,admin_fee:c?y(c.value):0,iptu:u?y(u.value):0,condo:d?y(d.value):0})}),n}function ae(){const e=document.getElementById("rentalPropertiesContainer");if(!e)return;const n=e.querySelectorAll(".rental-property-row").length,o=document.createElement("div");o.className="rental-property-row bg-neutral-50 p-4 rounded-lg border border-neutral-200",o.setAttribute("data-index",n),o.innerHTML=`
        <div class="flex justify-between items-start mb-3">
            <h5 class="text-sm font-semibold text-neutral-800">Imóvel #${n+1}</h5>
            <button type="button" onclick="removeRentalProperty(${n})" class="remove-rental-btn p-2 text-sm text-red-600 hover:text-red-700 hover:bg-red-50 border border-red-200 rounded-lg transition-colors">
                <svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 7l-.867 12.142A2 2 0 0116.138 21H7.862a2 2 0 01-1.995-1.858L5 7m5 4v6m4-6v6m1-10V4a1 1 0 00-1-1h-4a1 1 0 00-1 1v3M4 7h16"></path>
                </svg>
            </button>
        </div>
        <div class="space-y-4">
            <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
                <div>
                    <label class="block text-sm font-medium text-neutral-700 mb-1">Identificação do Imóvel</label>
                    <input type="text" name="rentalProperties[${n}][name]" placeholder="Ex: Apt Centro" class="w-full p-3 text-sm border border-neutral-300 rounded-lg focus:ring-brand-500 focus:border-brand-500 outline-none">
                </div>
                <div>
                    <label class="block text-sm font-medium text-neutral-700 mb-1">Periodicidade</label>
                    <select name="rentalProperties[${n}][periodicity]" class="form-select rental-periodicity-select w-full p-3 text-sm border border-neutral-300 rounded-lg focus:ring-brand-500 focus:border-brand-500 outline-none" onchange="updateRentalLabels(${n})">
                        <option value="monthly">Mensais</option>
                        <option value="annual">Anuais</option>
                    </select>
                </div>
            </div>
            <div>
                <label class="block text-sm font-medium text-neutral-700 mb-1">Aluguel Bruto <span class="rental-label-gross text-neutral-500 font-normal"></span></label>
                <div class="relative">
                    <span class="absolute left-3 top-3 text-neutral-400 text-sm">R$</span>
                    <input type="text" name="rentalProperties[${n}][gross]" placeholder="0,00" class="currency-input pl-10 w-full p-3 text-sm border border-neutral-300 rounded-lg focus:ring-brand-500 focus:border-brand-500 outline-none">
                </div>
            </div>
            <div>
                <label class="block text-sm font-medium text-neutral-700 mb-1">Taxa Adm. <span class="rental-label-admin text-neutral-500 font-normal"></span></label>
                <div class="relative">
                    <span class="absolute left-3 top-3 text-neutral-400 text-sm">R$</span>
                    <input type="text" name="rentalProperties[${n}][admin_fee]" placeholder="0,00" class="currency-input pl-10 w-full p-3 text-sm border border-neutral-300 rounded-lg focus:ring-brand-500 focus:border-brand-500 outline-none">
                </div>
            </div>
            <div>
                <label class="block text-sm font-medium text-neutral-700 mb-1">
                    IPTU
                    <span class="rental-label-iptu block text-neutral-500 font-normal text-xs"></span>
                </label>
                <div class="relative">
                    <span class="absolute left-3 top-3 text-neutral-400 text-sm">R$</span>
                    <input type="text" name="rentalProperties[${n}][iptu]" placeholder="0,00" class="currency-input pl-10 w-full p-3 text-sm border border-neutral-300 rounded-lg focus:ring-brand-500 focus:border-brand-500 outline-none">
                </div>
            </div>
            <div>
                <label class="block text-sm font-medium text-neutral-700 mb-1">Condomínio <span class="rental-label-condo text-neutral-500 font-normal"></span></label>
                <div class="relative">
                    <span class="absolute left-3 top-3 text-neutral-400 text-sm">R$</span>
                    <input type="text" name="rentalProperties[${n}][condo]" placeholder="0,00" class="currency-input pl-10 w-full p-3 text-sm border border-neutral-300 rounded-lg focus:ring-brand-500 focus:border-brand-500 outline-none">
                </div>
            </div>
        </div>
    `,e.appendChild(o),N(),M(n),o.querySelectorAll("input, select").forEach(r=>{r.addEventListener("input",f),r.addEventListener("change",f),r.type!=="checkbox"&&r.type!=="submit"&&r.type!=="button"&&r.addEventListener("keydown",O),r.classList.contains("currency-input")&&D(r)}),f()}function se(e){const t=document.getElementById("rentalPropertiesContainer");if(!t)return;const n=t.querySelector(`.rental-property-row[data-index="${e}"]`);!n||t.querySelectorAll(".rental-property-row").length<=1||(n.remove(),le(),N(),f())}function le(){const e=document.getElementById("rentalPropertiesContainer");if(!e)return;e.querySelectorAll(".rental-property-row").forEach((n,o)=>{n.setAttribute("data-index",o);const i=n.querySelector("h5");i&&(i.textContent=`Imóvel #${o+1}`);const r=n.querySelector('input[name*="[name]"]'),l=n.querySelector('select[name*="[periodicity]"]'),a=n.querySelector('input[name*="[gross]"]'),c=n.querySelector('input[name*="[admin_fee]"]'),u=n.querySelector('input[name*="[iptu]"]'),d=n.querySelector('input[name*="[condo]"]'),s=n.querySelector(".remove-rental-btn");r&&(r.name=`rentalProperties[${o}][name]`),l&&(l.name=`rentalProperties[${o}][periodicity]`,l.setAttribute("onchange",`updateRentalLabels(${o})`)),a&&(a.name=`rentalProperties[${o}][gross]`),c&&(c.name=`rentalProperties[${o}][admin_fee]`),u&&(u.name=`rentalProperties[${o}][iptu]`),d&&(d.name=`rentalProperties[${o}][condo]`),s&&s.setAttribute("onclick",`removeRentalProperty(${o})`)})}function M(e){const t=document.querySelector(`.rental-property-row[data-index="${e}"]`);if(!t)return;const n=t.querySelector(`select[name="rentalProperties[${e}][periodicity]"]`);if(!n)return;const i=n.value==="annual",r=t.querySelector(".rental-label-gross"),l=t.querySelector(".rental-label-admin"),a=t.querySelector(".rental-label-iptu"),c=t.querySelector(".rental-label-condo");r&&(r.textContent=i?"(total anual)":"(mensal)"),l&&(l.textContent=i?"(total anual)":"(mensal)"),a&&(a.textContent=i?"(total anual)":"(mensal)"),c&&(c.textContent=i?"(total anual)":"(mensal)"),f()}function N(){const e=document.getElementById("rentalPropertiesContainer");if(!e)return;const t=e.querySelectorAll(".rental-property-row");e.querySelectorAll(".remove-rental-btn").forEach(o=>{t.length<=1?o.classList.add("hidden"):o.classList.remove("hidden")})}function ce(){const e=s=>{const m=document.getElementById(s);return m?y(m.value):0},t=s=>{const m=document.getElementById(s);return m?m.checked:!1},n=document.getElementById("birthDate"),o=n&&n.value!==""?n.value:null,i=te(),r=ie();let l=0,a=0,c=0;i.forEach(s=>{l+=s.gross||0,a+=s.inss||0,c+=s.irrf||0});let u=0,d=0;return r.forEach(s=>{const p=(s.periodicity||"monthly")==="annual",g=p?(s.gross||0)/12:s.gross||0,x=p?(s.admin_fee||0)/12:s.admin_fee||0,h=p?(s.iptu||0)/12:s.iptu||0,S=p?(s.condo||0)/12:s.condo||0,v=x+h+S;u+=g,d+=Math.max(0,g-v)}),{birthDate:o,seriousIllness:t("seriousIllness"),incomeSources:i,rentalProperties:r,incomeMonthly:l/12,incomeAnnual:l,income13:e("income13"),dividendsTotal:e("dividendsTotal"),dividendsExcess:e("dividendsExcess"),jcpTotal:e("jcpTotal"),irrfJcpWithheld:e("irrfJcpWithheld"),financialInvestments:e("financialInvestments"),irrfExclusiveOther:e("irrfExclusiveOther"),taxExemptInvestments:e("taxExemptInvestments"),fiiDividends:e("fiiDividends"),otherExempt:e("otherExempt"),accountingProfit:e("accountingProfit"),distributedProfit:e("distributedProfit"),irpjPaid:e("irpjPaid"),csllPaid:e("csllPaid"),ownershipPercentage:e("ownershipPercentage")||100,incomeOther:d,taxPaid:e("taxPaid"),totalIrrfRetido:c,totalInssRetido:a,totalRentalGross:u,totalRentalNet:d,dependents:(()=>{const s=document.getElementById("dependents"),m=s&&s.value!==""?parseInt(s.value,10):0;return Number.isFinite(m)&&m>0?m:0})(),deductionHealth:e("deductionHealth"),deductionEducation:e("deductionEducation"),deductionPGBL:e("deductionPGBL")}}function de(e){if(!e||e<=0)return 0;const t=6e5;return e<=t?0:e-t}function G(){const e=document.getElementById("dividendsTotal"),t=document.getElementById("dividendsExcess"),n=document.getElementById("dividendsTaxInfo"),o=document.getElementById("dividendsExcessDisplay"),i=document.getElementById("dividendsTaxDisplay");if(!e||!t)return;const r=e.value,l=w(r),a=de(l),c=a*.1;t.value=a.toFixed(2),a>0&&n&&o&&i?(n.classList.remove("hidden"),o.textContent=a.toLocaleString("pt-BR",{minimumFractionDigits:2,maximumFractionDigits:2,style:"currency",currency:"BRL"}),i.textContent=c.toLocaleString("pt-BR",{minimumFractionDigits:2,maximumFractionDigits:2,style:"currency",currency:"BRL"})):n&&n.classList.add("hidden"),t.dispatchEvent(new Event("input",{bubbles:!0}))}function ue(e){let t=e.incomeAnnual||(e.incomeMonthly?e.incomeMonthly*12:0),n=t+e.totalRentalNet*12,o=0;if(e.birthDate){const I=new Date(e.birthDate),F=new Date;o=F.getFullYear()-I.getFullYear();const W=F.getMonth()-I.getMonth();(W<0||W===0&&F.getDate()<I.getDate())&&o--}o>=65&&(n=Math.max(0,n-24e3)),e.seriousIllness&&(n=e.totalRentalNet*12);const i=Math.min(n*window.IRPF_CONSTANTS.simplifiedRate,window.IRPF_CONSTANTS.simplifiedCap),r=n-i,l=V(Math.max(0,r));let a=!1,c=e.deductionEducation;c>window.IRPF_CONSTANTS.educationCap&&(a=!0,c=window.IRPF_CONSTANTS.educationCap);const u=Math.max(0,n*.12),d=Math.min(e.deductionPGBL,u),s=e.dependents*window.IRPF_CONSTANTS.deductionPerDependent+e.deductionHealth+c+d,m=Math.max(0,n-s),p=V(m),g=e.dividendsExcess>0?e.dividendsExcess*.1:0,x=e.irrfJcpWithheld&&e.irrfJcpWithheld>0?e.irrfJcpWithheld:(e.jcpTotal||0)*.15,h=e.income13>0?H(e.income13):0,S=Math.min(l,p),v=l<p,L=y(window.IRPFM_ADDITIONAL||0),T=S+g+h+L,K=L>0,j=(e.taxPaid||0)+(e.totalIrrfRetido||0),U=g+x+(e.irrfExclusiveOther||0),Y=K?j+U:j,E=T-Y,A=E<0,Z=A?Math.abs(E):E,P=t+e.totalRentalGross*12+e.income13+(e.dividendsTotal||0)+(e.jcpTotal||0)+(e.financialInvestments||0)+(e.taxExemptInvestments||0)+(e.fiiDividends||0),z=P>0?T/P*100:0;let $="SEM SALDO",k="text-sm font-bold text-neutral-600 mt-1",B="border-neutral-300";E>0?($="IMPOSTO A PAGAR",k="text-sm font-bold text-red-600 mt-1",B="border-red-500"):A&&($="A RESTITUIR",k="text-sm font-bold text-green-600 mt-1",B="border-green-500");let R="Preencha os dados para ver qual regime compensa mais.";P>0&&(Math.abs(l-p)<10?R="Resultados similares em ambos os regimes.":v?R='<span class="text-brand-700 font-bold">Recomendação:</span> O Desconto Simplificado economiza <strong>'+b(p-l)+"</strong>.":R='<span class="text-green-700 font-bold">Recomendação:</span> As Deduções Legais economizam <strong>'+b(l-p)+"</strong>.");const X={simplified:Math.round((l+g)*100)/100,legal:Math.round((p+g)*100)/100};return{grossTaxable:n,simplifiedDiscount:i,totalDeductions:s,dividendTax:g,irpfmAdditional:L,totalTaxLiability:T,taxPaid:e.taxPaid,finalResult:E,displayFinalResult:Z,effectiveRate:z,resultLabel:$,resultClass:k,cardBorder:B,recommendationText:R,educationWarning:a,chartData:X,isNegativeFinalResult:A,totalIncome:P}}function me(e,t){const n=(h,S)=>{const v=document.getElementById(h);v&&(v.textContent=S)};n("displayGrossIncome",b(t.grossTaxable)),n("displaySimplifiedDisc",`- ${b(t.simplifiedDiscount)}`),n("displayLegalDed",`- ${b(t.totalDeductions)}`),t.dividendTax>0&&n("displayDivTax",`+ ${b(t.dividendTax)}`);const o=document.getElementById("displayIrpfm");o&&(t.irpfmAdditional>0?(o.textContent=`+ ${b(t.irpfmAdditional)}`,o.parentElement.classList.remove("hidden")):o.parentElement.classList.add("hidden")),n("displayTaxDue",b(t.totalTaxLiability));const i=e.dividendsExcess>0?e.dividendsExcess*.1:0,r=e.irrfJcpWithheld&&e.irrfJcpWithheld>0?e.irrfJcpWithheld:(e.jcpTotal||0)*.15,l=t.irpfmAdditional>0,a=(e.taxPaid||0)+(e.totalIrrfRetido||0),c=i+r+(e.irrfExclusiveOther||0),u=l?a+c:a;n("displayTaxPaid",`- ${b(u)}`);const d=document.getElementById("finalResultValue");d&&(d.textContent=b(t.displayFinalResult));const s=document.getElementById("resultStatus");s&&(s.textContent=t.resultLabel,s.className=t.resultClass);const m=document.getElementById("resultCard");m&&(m.classList.remove("border-neutral-300","border-red-500","border-green-500"),m.classList.add(t.cardBorder));const p=document.getElementById("effectiveRate");p&&(p.textContent=`${t.effectiveRate.toLocaleString("pt-BR",{minimumFractionDigits:2,maximumFractionDigits:2})}%`);const g=document.getElementById("recommendationText");g&&(g.innerHTML=t.recommendationText);const x=document.getElementById("educationWarning");x&&x.classList.toggle("hidden",!t.educationWarning)}function pe(e){window.chartPayload&&(window.chartPayload.simplified=e.chartData.simplified,window.chartPayload.legal=e.chartData.legal,C&&(C.data.datasets[0].data=[window.chartPayload.simplified,window.chartPayload.legal],C.update()))}function f(){const e=ce(),t=ue(e);me(e,t),pe(t)}function J(e){document.querySelectorAll(".step-content").forEach(i=>i.classList.remove("active"));const t=document.getElementById(`step${e}`);t&&t.classList.add("active");const n=Math.min(100,Math.max(20,e*20)),o=document.getElementById("progressBar");o&&(o.style.width=`${n}%`),window.scrollTo({top:0,behavior:"smooth"})}function fe(e,t){const n=document.getElementById(e);if(!n)return;let o=parseInt(n.value||"0",10)+t;o<0&&(o=0),n.value=o,f()}function be(){const e=document.getElementById("detailsContent"),t=document.getElementById("detailsArrow");e&&e.classList.toggle("hidden"),t&&t.classList.toggle("rotate-180")}function ge(e){document.querySelectorAll(".product-content").forEach(o=>o.classList.add("hidden")),document.querySelectorAll(".product-tab").forEach(o=>{o.classList.remove("text-brand-700","bg-brand-50","border-b-2","border-brand-600"),o.classList.add("text-neutral-500")});const t=document.getElementById("content-"+e);t&&t.classList.remove("hidden");const n=document.getElementById("tab-"+e);n&&(n.classList.remove("text-neutral-500"),n.classList.add("text-brand-700","bg-brand-50","border-b-2","border-brand-600"))}function ye(){confirm("Deseja reiniciar o simulador?")&&(window.location=window.location.pathname)}function xe(){const e=document.getElementById("comparisonChart");e&&window.chartPayload&&(C=new _(e.getContext("2d"),{type:"bar",data:{labels:["Simplificado","Completo"],datasets:[{label:"Imposto Anual",data:[window.chartPayload.simplified,window.chartPayload.legal],backgroundColor:["rgba(59, 130, 246, 0.8)","rgba(34, 197, 94, 0.8)"],borderColor:["rgb(59, 130, 246)","rgb(34, 197, 94)"],borderWidth:2,borderRadius:8}]},options:{indexAxis:"y",responsive:!0,maintainAspectRatio:!1,plugins:{legend:{display:!1},tooltip:{callbacks:{label:function(n){return b(n.parsed.x)}}}},scales:{x:{beginAtZero:!0,grid:{display:!1},ticks:{callback:function(n){return"R$ "+(n/1e3).toFixed(0)+"k"}}},y:{grid:{display:!1}}}}}));const t=document.getElementById("holdingChart");t&&window.holdingData&&new _(t.getContext("2d"),{type:"bar",data:{labels:["PF","Holding"],datasets:[{label:"Imposto Mensal",data:[window.holdingData.pf||0,window.holdingData.pj||0],backgroundColor:["rgba(239, 68, 68, 0.8)","rgba(34, 197, 94, 0.8)"],borderRadius:8}]},options:{indexAxis:"y",responsive:!0,maintainAspectRatio:!1,plugins:{legend:{display:!1},tooltip:{callbacks:{label:function(n){return b(n.parsed.x)+"/mês"}}}},scales:{x:{beginAtZero:!0,grid:{display:!1}},y:{grid:{display:!1}}}}})}function O(e){if(e.key!=="Enter")return;e.preventDefault(),e.stopPropagation();const t=e.target,n=t.closest("form");if(!n)return;const o=t.closest(".step-content");if(!o)return;const i=o.querySelectorAll('input:not([type="hidden"]):not([type="submit"]):not([type="button"]):not([readonly]):not([disabled]), select:not([disabled]), textarea:not([readonly]):not([disabled])'),r=Array.from(i),l=r.indexOf(t);if(l===-1)return;let a=null;for(let d=l+1;d<r.length;d++){const s=r[d];if(s.offsetParent!==null){a=s;break}}if(a){a.focus(),a.tagName==="INPUT"&&(a.type==="text"||a.type==="number")&&a.select();return}const c=o.id,u=parseInt(c.replace("step",""));if(u<5)J(u+1),setTimeout(()=>{const d=document.getElementById(`step${u+1}`);if(d){const s=d.querySelector('input:not([type="hidden"]):not([type="submit"]):not([type="button"]):not([readonly]):not([disabled]), select:not([disabled]), textarea:not([readonly]):not([disabled])');s&&s.offsetParent!==null&&(s.focus(),s.tagName==="INPUT"&&(s.type==="text"||s.type==="number")&&s.select())}},150);else{const d=n.querySelector('button[type="submit"]');d&&d.click()}}function ve(){document.querySelectorAll('input[type="number"], input[type="checkbox"], input[type="text"], select, textarea').forEach(o=>{const i=o.type==="checkbox"?"change":"input";if(o.addEventListener(i,f),o.type!=="checkbox"&&o.type!=="submit"&&o.type!=="button"&&o.addEventListener("keydown",O,!0),o.classList.contains("currency-input")&&(D(o),o.value)){const r=w(o.value);if(r>0)if(o.value.includes(",")||o.value.includes(".")&&o.value.split(".").length>2){const a=r.toLocaleString("pt-BR",{minimumFractionDigits:2,maximumFractionDigits:2});o.value=a}else{const a=r.toLocaleString("pt-BR",{minimumFractionDigits:0,maximumFractionDigits:0});o.value=a}}});const t=document.getElementById("dividendsTotal");t&&(t.classList.contains("currency-input")||t.classList.add("currency-input"),D(t),t.addEventListener("input",function(o){setTimeout(()=>{G(),f()},0)})),q(),N(),document.querySelectorAll(".rental-property-row").forEach(o=>{const i=o.getAttribute("data-index");i!==null&&M(parseInt(i,10))}),G(),f()}function he(){const e=document.getElementById("resultCard");e&&(e.scrollIntoView({behavior:"smooth",block:"center"}),e.classList.add("ring-4","ring-brand-300","transform","scale-105"),setTimeout(()=>{e.classList.remove("ring-4","ring-brand-300","transform","scale-105")},1e3))}window.allowFormSubmit=!1;document.addEventListener("DOMContentLoaded",()=>{xe(),ve();const e=document.getElementById("taxForm");if(e){const t=e.querySelector('button[type="submit"]');t&&t.addEventListener("click",n=>{window.allowFormSubmit=!0}),e.addEventListener("submit",n=>{if(!window.allowFormSubmit)return n.preventDefault(),n.stopPropagation(),n.stopImmediatePropagation(),!1;window.allowFormSubmit=!1},!0),window.allowFormSubmit=!1}window.hasSubmission&&he()});window.nextStep=J;window.adjustCounter=fe;window.toggleDetails=be;window.showProductTab=ge;window.resetApp=ye;window.addIncomeSource=ne;window.removeIncomeSource=oe;window.addRentalProperty=ae;window.removeRentalProperty=se;window.updateRentalLabels=M;
